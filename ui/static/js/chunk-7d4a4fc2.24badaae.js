(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7d4a4fc2"],{"0eb1":function(e,t,r){"use strict";r.r(t);var n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"app-container"},[r("div",[r("el-row",{attrs:{gutter:10}},[r("el-col",{attrs:{span:12,xs:12}},[r("h5",[e._v("角色列表")]),r("cui-table",{ref:"roleTableBuilder",attrs:{config:e.roleTableConfig}})],1),r("el-col",{attrs:{span:12,xs:12}},[r("h5",[e._v("设置人员")]),r("div",{directives:[{name:"show",rawName:"v-show",value:e.editingId>0,expression:"editingId>0"}]},[r("cui-table",{ref:"staffTableBuilder",attrs:{config:e.staffTableConfig,selectedRows:e.selectedRows},on:{"update:selectedRows":function(t){e.selectedRows=t},"update:selected-rows":function(t){e.selectedRows=t}}})],1),r("div",{directives:[{name:"show",rawName:"v-show",value:""==e.editingId,expression:"editingId==''"}]},[e._v(" 请选择角色 ")])])],1)],1),r("cui-dialog-form",{ref:"roleDialogForm",attrs:{title:e.roleFormTile,formConfig:e.roleFormConfig,visible:e.roleFormVisible},on:{"update:visible":function(t){e.roleFormVisible=t},onSubmit:e.onRoleSubmit}}),r("cui-dialog-form",{ref:"roleUserDialogForm",attrs:{title:"选择人员",formConfig:e.roleUserFormConfig,visible:e.roleUserFormVisible},on:{"update:visible":function(t){e.roleUserFormVisible=t},onSubmit:e.onRoleUserSubmit}}),r("RolePermission",{attrs:{visible:e.permissionDialog,id:e.editingId},on:{"update:visible":function(t){e.permissionDialog=t}}})],1)},i=[],a=r("1da1"),o=(r("96cf"),r("d282")),s=r("8593"),u=r("ed44"),c=r("ed08"),l=r("cf45"),d=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("cui-dialog",{attrs:{title:"管理角色的权限",visible:e.dialogVisible,width:"700px"},on:{"update:visible":function(t){e.dialogVisible=t},submit:e.formSubmit}},e._l(e.permissionList,(function(t,n){return r("div",{key:n,staticClass:"normal-border padding margin"},[r("div",{staticClass:"margin-bottom"},[r("el-checkbox",{attrs:{indeterminate:e.isIndeterminate[n]},on:{change:function(t){return e.handleCheckAllChange(n)}},model:{value:e.checkAll[n],callback:function(t){e.$set(e.checkAll,n,t)},expression:"checkAll[permissionName]"}},[e._v(e._s(n))])],1),r("el-checkbox-group",{on:{change:e.handleCheckedChange},model:{value:e.selectedValue,callback:function(t){e.selectedValue=t},expression:"selectedValue"}},e._l(t,(function(t,n){return r("el-checkbox",{key:n,attrs:{label:t.id}},[e._v(e._s(t.name))])})),1)],1)})),0)},p=[],m=r("b85c"),f=(r("a434"),r("a15b"),r("61f7")),h={name:"RolePermission",components:{},props:{visible:{type:Boolean,required:!0},id:{require:!0}},data:function(){return{permissionResponse:[],permissionList:{},checkAll:{},isIndeterminate:{},selectedValue:[],checkedValue:[]}},computed:{dialogVisible:{get:function(){return this.visible&&this.id&&this.loadPermissionById(),!!this.visible},set:function(e){this.$emit("update:visible",e)}}},mounted:function(){this.handleRequest()},methods:{loadPermissionById:function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(){var t,r,n,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.selectedValue=[],console.log("loadPermissionById",this.id),e.next=4,Object(s["k"])(this.id);case 4:t=e.sent,console.log("res",t),r=Object(m["a"])(t);try{for(r.s();!(n=r.n()).done;)i=n.value,this.selectedValue.push(i.id)}catch(a){r.e(a)}finally{r.f()}this.handleCheckedChange();case 9:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),handleRequest:function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(){var t,r,n,i,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(s["h"])();case 2:t=e.sent,this.permissionResponse=t,r={},n=Object(m["a"])(t);try{for(n.s();!(i=n.n()).done;)a=i.value,Object(f["e"])(r[a.groupName])&&(r[a.groupName]=[],this.$set(this.isIndeterminate,a.groupName,!1),this.$set(this.checkAll,a.groupName,!1)),r[a.groupName].push(a)}catch(o){n.e(o)}finally{n.f()}this.permissionList=r;case 8:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),handleCheckAllChange:function(e){var t,r=Object(m["a"])(this.permissionResponse);try{for(r.s();!(t=r.n()).done;){var n=t.value;if(n.groupName==e)if(this.checkAll[e]){var i=!1;for(var a in this.selectedValue)if(this.selectedValue[a]==n.id){i=!0;break}i||this.selectedValue.push(n.id)}else for(var o in this.selectedValue)this.selectedValue[o]==n.id&&this.selectedValue.splice(o,1)}}catch(s){r.e(s)}finally{r.f()}},handleCheckedChange:function(){var e=this,t=function(t){var r=0;for(var n in e.permissionList[t])for(var i in e.selectedValue)if(e.selectedValue[i]==e.permissionList[t][n].id){r++;break}return r>0&&r==e.permissionList[t].length?"all":r>0?"part":"none"};for(var r in this.permissionList){var n=t(r);"all"==n?(this.isIndeterminate[r]=!1,this.checkAll[r]=!0):"part"==n?(this.isIndeterminate[r]=!0,this.checkAll[r]=!1):(this.isIndeterminate[r]=!1,this.checkAll[r]=!1)}},formSubmit:function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(0!=this.selectedValue.length){e.next=3;break}return Object(l["e"])("请先选择权限","error"),e.abrupt("return");case 3:return e.next=5,Object(s["c"])({roleId:this.id,permissionIds:this.selectedValue.join(",")});case 5:t=e.sent,Object(c["a"])(t)&&(Object(l["e"])(t.msg,"success"),this.$emit("update:visible",!1));case 7:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()}},b=h,g=r("2877"),v=Object(g["a"])(b,d,p,!1,null,null,null),w=v.exports,R={name:"Permission",components:{RolePermission:w},data:function(){var e=this;return{editingId:"",roleTableConfig:{url:o["a"].rbacRoleList,condition:{},rowClick:function(t){e.changeRole(t)},fields:[{title:"角色名",name:"name"},{title:"编码",name:"code"}],actionWidth:"200",actions:[{title:"管理权限",visible:function(e){return"superadmin"!=e.code},click:function(t){e.editingId=t.id,e.permissionDialog=!0}},{title:"编辑",visible:function(e){return"superadmin"!=e.code},click:function(t){e.roleFormVisible=!0,e.roleFormTile="修改角色信息",e.$refs.roleDialogForm.initFormData(t)}},{title:"删除",visible:function(e){return"superadmin"!=e.code},click:function(t){e.deleteRole(t.id)}}],topActions:[{title:"添加角色",icon:"el-icon-plus",type:"primary",click:function(){e.roleFormVisible=!0,e.roleFormTile="添加角色",e.$refs.roleDialogForm.onReset()}}]},staffTableConfig:{url:o["a"].rbacUsersByRoleId,condition:{roleId:""},autoLoad:!1,selectable:!0,emptyText:"请选择角色",fields:[{title:"员工姓名",name:"name"},{title:"手机号",name:"mobile"}],topActions:[{title:"给角色配置人员",type:"primary",icon:"el-icon-plus",click:function(){e.roleUserFormVisible=!0,e.$refs.roleUserDialogForm.onReset()}},{title:"从角色移除人员",icon:"el-icon-delete",click:function(){u["a"].deleteRoleUser(e.editingId,e.selectedRows,(function(){return e.$refs.staffTableBuilder.loadData()}))}}]},selectedRows:[],roleFormConfig:{fields:[{label:"角色名称",name:"name",type:"input"},{label:"英文编码",name:"code",type:"input"}],rules:{name:[{required:!0,message:"请输入角色名称"}],code:[{required:!0,message:"请输入编码"}]}},roleFormVisible:!1,roleFormTile:"",roleUserFormConfig:{fields:[{label:"请选择人员",name:"userIds",type:"selectBox",code:"staff"}],rules:{userIds:[{required:!0,message:"请选择人员"}]}},roleUserFormVisible:!1,permissionDialog:!1}},computed:{},methods:{changeRole:function(e){this.staffTableConfig.condition={roleId:e.id},this.$refs.staffTableBuilder.loadData(),this.editingId=e.id},deleteRole:function(e){var t=this;u["a"].deleteRole(e,(function(){t.$refs.roleTableBuilder.loadData()}))},onRoleSubmit:function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(t){var r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(s["m"])(t);case 2:r=e.sent,Object(c["a"])(r)&&(this.$refs.roleDialogForm.onReset(),this.$refs.roleTableBuilder.loadData());case 4:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),onRoleUserSubmit:function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(t){var r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(this.editingId){e.next=3;break}return Object(l["e"])("请先选择角色","error"),e.abrupt("return");case 3:return t.roleId=this.editingId,e.next=6,Object(s["d"])(t);case 6:r=e.sent,Object(c["a"])(r)&&(this.$refs.roleUserDialogForm.onReset(),this.$refs.staffTableBuilder.loadData());case 8:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()}},O=R,j=Object(g["a"])(O,n,i,!1,null,null,null);t["default"]=j.exports},8593:function(e,t,r){"use strict";r.d(t,"h",(function(){return o})),r.d(t,"k",(function(){return u})),r.d(t,"m",(function(){return l})),r.d(t,"e",(function(){return p})),r.d(t,"d",(function(){return f})),r.d(t,"b",(function(){return b})),r.d(t,"f",(function(){return v})),r.d(t,"c",(function(){return R})),r.d(t,"i",(function(){return j})),r.d(t,"j",(function(){return k})),r.d(t,"n",(function(){return T})),r.d(t,"o",(function(){return V})),r.d(t,"p",(function(){return F})),r.d(t,"g",(function(){return S})),r.d(t,"a",(function(){return U})),r.d(t,"l",(function(){return B}));var n=r("1da1"),i=(r("96cf"),r("b775")),a=r("d282");function o(e){return s.apply(this,arguments)}function s(){return s=Object(n["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(i["a"])({url:a["a"].rbacPermissionsList,method:"GET",params:t}));case 1:case"end":return e.stop()}}),e)}))),s.apply(this,arguments)}function u(e){return c.apply(this,arguments)}function c(){return c=Object(n["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(i["a"])({url:a["a"].rbacPermissionsByRoleId,method:"GET",params:{roleId:t}}));case 1:case"end":return e.stop()}}),e)}))),c.apply(this,arguments)}function l(e){return d.apply(this,arguments)}function d(){return d=Object(n["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(i["a"])({url:"/common/rbac/saveRole",method:"POST",data:t}));case 1:case"end":return e.stop()}}),e)}))),d.apply(this,arguments)}function p(e){return m.apply(this,arguments)}function m(){return m=Object(n["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(i["a"])({url:"/common/rbac/deleteRole",method:"POST",params:{id:t}}));case 1:case"end":return e.stop()}}),e)}))),m.apply(this,arguments)}function f(e){return h.apply(this,arguments)}function h(){return h=Object(n["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(i["a"])({url:"/common/rbac/bindRoleToUsers",method:"POST",params:t}));case 1:case"end":return e.stop()}}),e)}))),h.apply(this,arguments)}function b(e,t){return g.apply(this,arguments)}function g(){return g=Object(n["a"])(regeneratorRuntime.mark((function e(t,r){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(i["a"])({url:"/common/rbac/batchBindRoleToUsers",method:"POST",data:{roleIds:t,staffIds:r}}));case 1:case"end":return e.stop()}}),e)}))),g.apply(this,arguments)}function v(e){return w.apply(this,arguments)}function w(){return w=Object(n["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(i["a"])({url:"/common/rbac/deleteRoleUser",method:"POST",params:t}));case 1:case"end":return e.stop()}}),e)}))),w.apply(this,arguments)}function R(e){return O.apply(this,arguments)}function O(){return O=Object(n["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(i["a"])({url:"/common/rbac/bindPermissionsToRole",method:"POST",params:t}));case 1:case"end":return e.stop()}}),e)}))),O.apply(this,arguments)}function j(){return y.apply(this,arguments)}function y(){return y=Object(n["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(i["a"])({url:"/common/sys/settingList",method:"GET"}));case 1:case"end":return e.stop()}}),e)}))),y.apply(this,arguments)}function k(e){return x.apply(this,arguments)}function x(){return x=Object(n["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(i["a"])({url:"/common/sys/settingOptions",method:"GET",params:{id:t}}));case 1:case"end":return e.stop()}}),e)}))),x.apply(this,arguments)}function T(e){return I.apply(this,arguments)}function I(){return I=Object(n["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(i["a"])({url:"/common/sys/saveSettingOption",method:"POST",data:t}));case 1:case"end":return e.stop()}}),e)}))),I.apply(this,arguments)}function V(e){return C.apply(this,arguments)}function C(){return C=Object(n["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(i["a"])({url:"/common/sys/settingNoticeList",method:"GET",params:{group:t}}));case 1:case"end":return e.stop()}}),e)}))),C.apply(this,arguments)}function F(e){return P.apply(this,arguments)}function P(){return P=Object(n["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(i["a"])({url:"/common/sys/settingNoticeSave",method:"GET",params:t}));case 1:case"end":return e.stop()}}),e)}))),P.apply(this,arguments)}function S(){return D.apply(this,arguments)}function D(){return D=Object(n["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(i["a"])({url:"/common/holiday/list",method:"GET"}));case 1:case"end":return e.stop()}}),e)}))),D.apply(this,arguments)}function U(e){return $.apply(this,arguments)}function $(){return $=Object(n["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(i["a"])({url:"/common/holiday/add/"+t,method:"POST"}));case 1:case"end":return e.stop()}}),e)}))),$.apply(this,arguments)}function B(e){return A.apply(this,arguments)}function A(){return A=Object(n["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(i["a"])({url:"/common/holiday/delete/"+t,method:"POST"}));case 1:case"end":return e.stop()}}),e)}))),A.apply(this,arguments)}},ed44:function(e,t,r){"use strict";var n=r("1da1"),i=(r("a15b"),r("96cf"),r("cf45")),a=(r("2934"),r("8593")),o=r("ed08");t["a"]={deleteRole:function(e,t){Object(i["b"])("确认删除该角色?",Object(n["a"])(regeneratorRuntime.mark((function r(){var n;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,Object(a["e"])(e);case 2:n=r.sent,Object(o["a"])(n)&&t(n);case 4:case"end":return r.stop()}}),r)}))))},deleteRoleUser:function(e,t,r){""!=e?Object(i["a"])(t,"请先选择")&&Object(i["b"])("确认从所选角色中移除该人员?",Object(n["a"])(regeneratorRuntime.mark((function n(){var s;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,Object(a["f"])({roleId:e,userIds:Object(i["d"])(t).join(",")});case 2:s=n.sent,Object(o["a"])(s)&&r(s);case 4:case"end":return n.stop()}}),n)})))):Object(i["e"])("请先选择角色","error")}}}}]);